---
title: "线上实验二：基础原理"
date: "2024-05-27"
keywords: ["实验指标"]
series: "Causal-Inference"
---

本文是《Trustworthy Online Controlled Experiments》（中文版《关键迭代：可信赖的线上对照试验》）的第二部分（5-9章）主要内容的总结。

# 第5章：速度很重要
本章通过一个端到端的案例研究，从局部线性近似的假设、网站性能的测量、减速实验的设计、对不同页面元素的影响以及极端结果的影响，探讨了网页速度对用户体验和收入的重要性。感兴趣的读者可以自行阅读详细内容。

# 第6章：机构指标

### 1. 指标的分类（Metrics Taxonomy）
- **目标指标（Goal Metrics）**：也被称为成功指标或北极星指标（Success Metrics or True North Metrics），这些指标直接反映了业务目标和最终成功。
- **驱动指标（Driver Metrics）**：也称为路标指标、代理指标、间接或预测指标（Sign Post Metrics, Surrogate Metrics, Indirect or Predictive Metrics），这些指标帮助考量驱动成功的因素。例如 AARRR 框架（Acquisition 获取、Activation 激活、Retention 留存、Referral 传播以及 Revenue 营收）或常用的用户漏斗方法。
- **护栏指标（Guardrail Metrics）**：这些指标主要用于保护业务，评估实验结果的可信赖度和内部有效性，以确保不会违背重要的限制。例如第五章提到的网页延迟等灵敏指标、页面平均错误数、客户端崩溃数等。

### 2. 指标的制定：原则与技术（Formulating Metrics: Principles and Techniques）

1. 确保你的目标指标是：
   - **简单的**：易于理解并且可以被利益相关者广泛接受。
   - **稳定的**：不需要每次都为了一个新功能而更新目标指标。

2. 确保驱动指标是：
   - **与目标一致的**：验证驱动指标确实可以驱动成功。一个常用的验证技术是专门为此目的设计的线上实验。
   - **可行动的和相关的**：团队有途径（如通过产品功能）去改变这些指标。
   - **灵敏的**：驱动指标是目标指标的先导指数。需要确保它们足够灵敏，能够衡量出大部分改动的效果。
   - **不容易被操纵的**：如可以通过牺牲客户生命周期价值（Lifetime Value，简称 LTV）以提高短期收益指标。

制定指标时，可以通过小规模实验得到的假设去形成想法，然后用大型数据分析来验证这些想法，从而做出精确的定义。
其他考量：指标质量，保持模型的可解释性和可验证性。

### 3. 指标的评估和演变（Evaluating and Evolving Metrics）
- 添加新指标之前，需要评估它是否能在现有指标的基础上带来额外信息。
- 终生价值指标必须定期评估，以确保预测误差保持在一个很低的水平。
- 用于线上实验的重要指标必须定期评估，以确定它们是否在鼓励指标操纵。
- 评估驱动指标与目标指标之间的因果关系。

随着业务、环境和对指标理解的变化，基础框架需要保持更新，收集相应数据。

# 第7章：实验指标和总体评估指标

### 1. 从业务指标到适用于实验的指标

合适的实验用的指标应具备以下特点：

1. **可测量性（Measurable）**：指标必须能够通过数据进行准确测量。例如，购买后的满意度可能难以测量。
2. **可归因性（Attributable）**：指标值必须能够归因于实验变体。例如，分析处理组是否比对照组导致更高的应用崩溃率。
3. **灵敏性和及时性（Sensitive and Timely）**：指标必须足够灵敏并能及时检测到差异。例如，全页面点击率、成功下单率和成功时间等。

示例：

- 广告收入：使用添加阈值的营收以避免少数离群值导致的大方差。
- 订阅续订率：很难进行长时间实验测量续订率，选择服务的使用量作为代理指标。

### 2. 将关键指标组合成一个OEC

将多个关键指标组合成一个单一的加权组合可能一开始很难，但可以从以下四种情况开始分类决策：

1. 所有关键指标平稳（无统计显著性）或正向（具有统计显著性），至少有一个指标为正，则发布变更。
2. 所有关键指标平稳或负向，至少有一个指标为负，则不发布变更。
3. 所有关键指标平稳，则不发布变更，考虑提升实验功效、放弃或者改变产品方向。
4. 一些关键指标为正，一些关键指标为负：根据权衡作出决定。即给关键指标分配权重。

如果没有合适的权重，尽可能减少关键指标的数量，经验法则推荐为5。

#### 亚马逊邮件的OEC
亚马逊在评估邮件效果时，采用了以下的OEC公式：

$$
\text{OEC} = \left( \sum_{i} \text{Rev}_{i} - s \times \text{unsubscribe\_lifetime\_loss} \right) / n
$$

其中：

- $i$ 表示变体中的邮件接收者
- $s$ 是变体中的退订人数
- $\text{unsubscribe\_lifetime\_loss}$ 是假设终生无法给用户发邮件，所带来的估计的营收损失
- $n$ 是变体中的用户数量

#### 必应搜索引擎的OEC
必应搜索引擎的OEC公式如下：

$$
n \frac{\text{Users}}{\text{Month}} \times \frac{\text{Sessions}}{\text{User}} \times \frac{\text{Distinct queries}}{\text{Session}}
$$

这个公式用于衡量月用户数量、人均会话数以及会话平均的去重查询个数。其中需要增加人均会话数。

# 第8章：机构的经验传承与统合分析
机构经验在以下几个方面发挥重要作用：实验文化、最佳实践、未来创新、指标制定和实证研究。详细的解释请参阅原文。

# 第9章：对照实验中的伦理

本章探讨了对照实验中的伦理问题，强调需要权衡实验研究的收益与参与者的风险，并遵循数据收集过程中的伦理原则，包括标识数据和匿名数据的概念。更多细节请参阅原文。

### 参考文献

- Kohavi, Ron, Diane Tang, and Ya Xu. *Trustworthy Online Controlled Experiments: A Practical Guide to A/B Testing (关键迭代：可信赖的线上对照试验)*. Cambridge University Press, 2020.

### 留言区
欢迎在下方留言讨论。如果您无法输入评论，请确保您已登录 GitHub 账号。

{{< include ../../_includes/utterances.html >}}